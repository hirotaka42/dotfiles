# macOS 辞書設定マニュアル

## 概要
macOSで日本語入力辞書を設定する手順について説明します。

## 前提条件
- macOS 10.15 (Catalina) 以降推奨
- 日本語キーボード/入力ソースが設定済み
- 辞書ファイル (`.plist`形式) が準備済み

## 辞書ファイルの準備

### Web編集ツールを使用する場合
1. Web編集ツールでJSONファイルを読み込み
2. 必要なカテゴリを選択
3. 「macOS用(.plist)で出力」ボタンをクリック
4. `dictionary.plist` ファイルをダウンロード

### コマンドラインツールを使用する場合
```bash
cd tools/converter
# 全カテゴリをplist形式で出力
python3 convert.py ../../data/dictionary.json --macos dictionary.plist

# 特定カテゴリのみを出力
python3 convert.py ../../data/dictionary.json --macos dictionary.plist --categories "記号・マーク,矢印"
```

## 辞書のインポート手順

### 方法1: システム設定からインポート（推奨）

#### 1. システム設定を開く
- アップルメニュー  > システム設定
- または、Spotlight検索 (⌘ + Space) で「システム設定」

#### 2. キーボード設定を開く
- 左側のメニューから「キーボード」をクリック
- 「入力ソース」セクションの「編集...」をクリック

#### 3. 日本語入力の設定
- 入力ソース一覧から「日本語 - ローマ字入力」または「日本語」を選択
- 右下の「ユーザ辞書...」ボタンをクリック

#### 4. .plistファイルを読み込む
- ユーザ辞書ウィンドウの左下「+」ボタン横の三本線メニューをクリック
- 「ファイルから読み込む...」を選択
- 準備した `.plist` ファイルを選択
- 「開く」をクリック

#### 5. 確認
- インポートされた単語がユーザ辞書に表示されることを確認
- ウィンドウを閉じる

### 方法2: 直接配置する方法

```bash
# ユーザ辞書ディレクトリに直接配置
cp dictionary.plist ~/Library/Dictionaries/UserDictionary.plist

# 日本語入力を再起動
killall JapaneseIM
```

**注意**: この方法は既存のユーザ辞書を上書きします。バックアップを取ってから実行してください。

## 辞書の内容確認

### インポートされた辞書の確認方法
1. 任意のテキストエディタを開く
2. 登録した読みを入力
3. スペースキーまたは変換キーを押して変換候補を確認

### 例：技術用語の確認
- 「js」と入力 → 「JavaScript」が候補に表示
- 「api」と入力 → 「API」が候補に表示
- 「おつ」と入力 → 「お疲れ様です」が候補に表示

## トラブルシューティング

### 辞書がインポートできない場合
1. **ファイル形式の確認**
   - ファイルがUTF-8エンコーディングで保存されているか確認
   - タブ区切りの形式になっているか確認

2. **権限の確認**
   - ファイルの読み取り権限があるか確認
   - 必要に応じて `chmod 644 dictionaries/merged_dictionary.txt`

3. **ファイルサイズの確認**
   - ファイルサイズが大きすぎないか確認（推奨：10MB以下）
   - 必要に応じて辞書を分割してインポート

### 変換候補に表示されない場合
1. **IMEの再起動**
   - システム環境設定で一度日本語入力を削除
   - 再度日本語入力を追加

2. **学習辞書のクリア**
   - 日本語入力の設定で「学習辞書をリセット」を実行

3. **システムの再起動**
   - macOS自体を再起動

## 個人辞書の管理

### 個人辞書ファイルの作成
個人用の辞書を作成する場合：

1. `dictionaries/personal/names.txt.example` をコピー
2. `dictionaries/personal/names.txt` にリネーム
3. 個人的な固有名詞を追加
4. セットアップスクリプトを再実行

### プライバシー設定
個人辞書をGitで管理したくない場合：
- `.gitignore` に `dictionaries/personal/` が含まれていることを確認
- ローカルのみで管理される

## 辞書の更新

### 新しい単語の追加
1. 該当するカテゴリの辞書ファイルに単語を追加
2. セットアップスクリプトを再実行
3. 新しい統合辞書をインポート

### カテゴリ別の管理
- `dictionaries/common/` - 共通単語
- `dictionaries/tech/` - 技術用語
- `dictionaries/business/` - ビジネス用語
- `dictionaries/personal/` - 個人用語

## バックアップとリストア

### バックアップファイルの場所
セットアップスクリプト実行時に作成される：
```
~/.dotfiles_dictionary_backup_YYYYMMDD_HHMMSS/
```

### バックアップからのリストア
1. バックアップディレクトリから設定ファイルをコピー
2. システム環境設定で辞書設定をリセット
3. バックアップファイルをインポート

## 参考情報

### 関連ファイル
- `/System/Library/Input Methods/JapaneseIM.app/` - 日本語入力システム
- `~/Library/Preferences/com.apple.inputmethod.Kotoeri.plist` - 辞書設定

### 便利なキーボードショートカット
- `Control + Shift + ;` - 辞書機能を開く
- `Control + Shift + J` - 日本語入力モードの切り替え